@if (form$ | async; as form) {
<form [formGroup]="form" (ngSubmit)="save(form)">
  <mat-form-field>
    <mat-label for="name">Name</mat-label>
    <input matInput id="name" formControlName="name" />
  </mat-form-field>
  <mat-form-field>
    <mat-label for="description">Description</mat-label>
    <textarea
      matInput
      id="description"
      formControlName="description"
    ></textarea>
  </mat-form-field>
  @if(collection$ | async; as collection){
  <div class="kpis">
    @for (valueForm of form.controls.values.controls; track $index) {
    <div class="form-group" [formGroup]="valueForm">
      <mat-label for="name">{{ valueForm.value.name }}</mat-label>
      <mat-form-field>
        <mat-label for="description">Description</mat-label>
        <textarea
          matInput
          id="description"
          formControlName="description"
        ></textarea>
      </mat-form-field>
      <mat-form-field>
        <mat-label for="value">Value</mat-label>
        <input matInput type="number" id="value" formControlName="value" />
      </mat-form-field>
    </div>
    }
  </div>
  }
  <button
    mat-raised-button
    color="primary"
    *ngIf="form.dirty"
    [disabled]="!form.valid"
    type="submit"
  >
    Save
  </button>
  <button mat-stroked-button type="button" routerLink="..">Cancel</button>
</form>
}
